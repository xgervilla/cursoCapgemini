<!DOCTYPE html>
<html lang="es">
<head>
	<meta charset='utf-8'>
	<title>Curso de Capgemini</title>
	<meta name='viewport' content='width=device-width, initial-scale=1'>
	<link rel='stylesheet' type='text/css' media='screen' href='main.css'>
	<link rel='stylesheet' href='./node_modules/bootstrap/dist/css/bootstrap.css'>
	<script src="demo.js"></script>
</head>
<body>
	<header>
		<h1 id="pagetitle">Operaciones con num√©ricos</h1>
	</header>

	<div class="container">
		<div class="row justify-content-center">
			<div class="col-lg-6">
				<div class="row-cols-6">
					<input type="button" id="inversa" value="1/x">
					<input type="button" id="modulo" value="%">
					<input type="button" id="exponencial" value="exp">
					<input type="button" id="multiplica" value="*">
				</div>
				<div class="row-cols-6">
					<input type="button" id="number7" value="7">
					<input type="button" id="number8" value="8">
					<input type="button" id="number9" value="9">
					<input type="button" id="divide" value="/">
				</div>
				<div class="row-cols-6">
					<input type="button" id="number4" value="4">
					<input type="button" id="number5" value="5">
					<input type="button" id="number6" value="6">
					<input type="button" id="suma" value="+">
				</div>
				<div class="row-cols-6">
					<input type="button" id="number1" value="1">
					<input type="button" id="number2" value="2">
					<input type="button" id="number3" value="3">
					<input type="button" id="resta" value="-">
				</div>
				<div class="row-cols-6">
					<input type="button" id="number0" value="0">
					<input type="button" id="clear" value="C">
					<input type="button" id="decimal" value=",">
					<input type="button" id="calcula" value="=">
				</div>
			</div>
		</div>
		<div class="row">
			<output>Total: 0</output>
		</div>
		<script type="module">
			//funcion anonima
			(function(){
				localStorage.lastResult = 0;
				localStorage.accumulator = 0;
				localStorage.lastOP = 'none';
				
				let result = document.querySelector('output')

				let btnSuma = document.querySelector('#suma')
				let btnResta = document.querySelector('#resta')
				let btnDivide = document.querySelector('#divide')
				let btnMultiplica = document.querySelector('#multiplica')
				let btnModulo = document.querySelector('#modulo')
				let btnExponencial = document.querySelector('#exponencial')
				let btnInversa = document.querySelector('#inversa')
				let btnClear = document.querySelector('#clear')

				let btnNumber0 = document.querySelector('#number0')
				let btnNumber1 = document.querySelector('#number1')
				let btnNumber2 = document.querySelector('#number2')
				let btnNumber3 = document.querySelector('#number3')
				let btnNumber4 = document.querySelector('#number4')
				let btnNumber5 = document.querySelector('#number5')
				let btnNumber6 = document.querySelector('#number6')
				let btnNumber7 = document.querySelector('#number7')
				let btnNumber8 = document.querySelector('#number8')
				let btnNumber9 = document.querySelector('#number9')

				let btnCalcula = document.querySelector('#calcula')

				let applyOperation = (value) => {
					console.log(value)
					switch(localStorage.lastOP){
						case('suma'):
							localStorage.lastResult = +localStorage.lastResult + +localStorage.accumulator
							localStorage.accumulator = 0
							break
						case('resta'):
							localStorage.lastResult = +localStorage.lastResult - +localStorage.accumulator
							localStorage.accumulator = 0
							break;
						case('division'):
							localStorage.lastResult = localStorage.lastResult / localStorage.accumulator
							localStorage.accumulator = 0
							break;
						case('multiplicacion'):
							localStorage.lastResult = localStorage.lastResult * localStorage.accumulator
							localStorage.accumulator = 0
							break;
						case('modulo'):
							localStorage.lastResult = localStorage.lastResult % localStorage.accumulator
							break;
						case('exponenciacion'):
							localStorage.lastResult = localStorage.lastResult ** localStorage.accumulator
							localStorage.accumulator = 0
							break;
						case('inversa'):
							if(localStorage.accumulator != 0)
								localStorage.lastResult = 1 / localStorage.accumulator
							else if(localStorage.lastResult != 0)
								localStorage.lastResult = 1 / localStorage.lastResult
							localStorage.accumulator = 0
							break
						case('none'):
							localStorage.lastResult = +localStorage.accumulator
							localStorage.accumulator = 0
							break
						case('calculate'):
							break
					}
					if (value == 'clear'){
							localStorage.lastResult = +0
							localStorage.accumulator = +0
							result.textContent = 'Total: 0'
							localStorage.lastOP = 'none'
					}
					else{
						result.textContent = 'Acumulado: ' + localStorage.lastResult
						localStorage.lastOP = value
					}
				}

				let accumulateValues = (value) => {
					localStorage.accumulator = (localStorage.accumulator * 10) + value;
					result.textContent = 'Acumulado: ' + +localStorage.accumulator
				}

				btnSuma.addEventListener('click', () => {applyOperation('suma')})
				btnResta.addEventListener('click', () => {applyOperation('resta')})
				btnDivide.addEventListener('click', () => {applyOperation('division')})
				btnMultiplica.addEventListener('click', () => {applyOperation('multiplicacion')})
				btnModulo.addEventListener('click', () => {applyOperation('modulo')})
				btnExponencial.addEventListener('click', () => {applyOperation('exponenciacion')})
				btnInversa.addEventListener('click', () => {applyOperation('inversa')})
				btnClear.addEventListener('click', () => {applyOperation('clear')})

				btnCalcula.addEventListener('click',() => {applyOperation('calculate')})
				
				btnNumber0.addEventListener('click', () => {accumulateValues(0)})
				btnNumber1.addEventListener('click', () => {accumulateValues(1)})
				btnNumber2.addEventListener('click', () => {accumulateValues(2)})
				btnNumber3.addEventListener('click', () => {accumulateValues(3)})
				btnNumber4.addEventListener('click', () => {accumulateValues(4)})
				btnNumber5.addEventListener('click', () => {accumulateValues(5)})
				btnNumber6.addEventListener('click', () => {accumulateValues(6)})
				btnNumber7.addEventListener('click', () => {accumulateValues(7)})
				btnNumber8.addEventListener('click', () => {accumulateValues(8)})
				btnNumber9.addEventListener('click', () => {accumulateValues(9)})





			})();
		</script>
	</div>

	<!--Ejemplo de inyeccion de javascript-->
	<script>
		console.log('Main page ejecutando');
	</script>
</body>
</html>